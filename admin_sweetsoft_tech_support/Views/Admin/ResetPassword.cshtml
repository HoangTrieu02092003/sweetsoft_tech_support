@{
    Layout = null;
}
<!-- Stylesheets -->
<link href="~/assets/css/styles.min.css" rel="stylesheet" />
<link href="~/assets/libs/bootstrap/dist/css/bootstrap.min.css" />

<!-- Custom CSS -->
<style>
    .reset-password-container {
        width: 100%;
        max-width: 400px;
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 8px;
        background: #f9f9f9;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .reset-password-title {
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 1rem;
        color: #6a1b9a; /* Màu tím cho tiêu đề */
    }

    .form-floating-label {
        position: relative;
        margin-bottom: 1.5rem;
    }

        .form-floating-label input {
            width: 100%;
            padding: 12px 16px;
            font-size: 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: transparent;
            outline: none;
            transition: all 0.2s ease-in-out;
        }

        .form-floating-label label {
            position: absolute;
            top: 50%;
            left: 16px;
            transform: translateY(-50%);
            padding: 0 4px;
            font-size: 1rem;
            color: #aaa;
            pointer-events: none;
            transition: all 0.2s ease-in-out;
        }

        .form-floating-label input:focus {
            border-color: #6a1b9a; /* Màu xanh khi focus */
        }

            .form-floating-label input:focus + label,
            .form-floating-label input:not(:placeholder-shown) + label {
                top: -8px;
                transform: translateY(0) scale(0.85);
                background-color: #f9f9f9;
                color: #6a1b9a; /* Màu xanh khi focus */
            }

    .input-group {
        position: relative;
    }

        .input-group .input-group-text {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
        }

            .input-group .input-group-text:hover {
                color: #6a1b9a; /* Màu xanh khi hover */
            }

    .btn-primary {
        background-color: #ffb300; /* Màu vàng cho nút */
        border-color: #ffb300;
    }

        .btn-primary:hover {
            background-color: #e68900; /* Màu vàng đậm khi hover */
            border-color: #e68900;
        }

    a {
        color: #6a1b9a; /* Màu tím cho liên kết */
    }

        a:hover {
            color: #ffb300; /* Màu vàng khi hover */
        }
</style>

<!-- Reset Password Form -->
<div class="d-flex justify-content-center align-items-center mt-5">
    <div class="reset-password-container">
        <h2 class="reset-password-title text-center">Đặt lại mật khẩu</h2>

        @if (ViewData.ModelState[""]?.Errors.Count > 0)
        {
            <div class="alert alert-danger">
                @foreach (var error in ViewData.ModelState[""].Errors)
                {
                    <p class="mb-0">@error.ErrorMessage</p>
                }
            </div>
        }

        <form method="post" class="needs-validation" novalidate>
            <input type="hidden" name="token" value="@ViewData["Token"]" />

            <div class="form-floating-label input-group">
                <input type="password" id="password" name="password" placeholder=" " required />
                <label for="password">Mật khẩu mới</label>
                <span class="input-group-text" id="togglePassword">
                    <i class="fas fa-eye"></i>
                </span>
                <div class="invalid-feedback">
                    Vui lòng nhập mật khẩu.
                </div>
            </div>

            <div class="form-floating-label input-group">
                <input type="password" id="confirmPassword" name="confirmPassword" placeholder=" " required />
                <label for="confirmPassword">Xác nhận mật khẩu</label>
                <span class="input-group-text" id="toggleConfirmPassword">
                    <i class="fas fa-eye"></i>
                </span>
            </div>

            <button type="submit" class="btn btn-primary w-100">Đặt lại mật khẩu</button>
        </form>

        <div class="text-center mt-3">
            <a href="Login">Quay lại trang đăng nhập</a>
        </div>
    </div>
</div>

<!-- JavaScript -->
<script>
    // Show/Hide Password functionality for both fields
    const togglePassword = document.querySelector('#togglePassword');
    const passwordField = document.querySelector('#password');
    const toggleConfirmPassword = document.querySelector('#toggleConfirmPassword');
    const confirmPasswordField = document.querySelector('#confirmPassword');

    togglePassword.addEventListener('click', () => {
        const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordField.setAttribute('type', type);

        // Toggle icon for password field
        togglePassword.innerHTML =
            type === 'password'
                ? '<i class="fas fa-eye"></i>'
                : '<i class="fas fa-eye-slash"></i>';
    });

    toggleConfirmPassword.addEventListener('click', () => {
        const type = confirmPasswordField.getAttribute('type') === 'password' ? 'text' : 'password';
        confirmPasswordField.setAttribute('type', type);

        // Toggle icon for confirm password field
        toggleConfirmPassword.innerHTML =
            type === 'password'
                ? '<i class="fas fa-eye"></i>'
                : '<i class="fas fa-eye-slash"></i>';
    });
    // Function to validate password
    function validatePassword(password) {
        // At least 8 characters, 1 uppercase letter, 1 number, no diacritics, no spaces
        const regex = /^(?=.*[A-Z])(?=.*\d)[A-Za-z0-9]{8,}$/;
        return regex.test(password) && !/[àáâãäåæçèéêëìíîïðñòóôõöøùúûüýÿÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÿ]/.test(password);
    }

    // Add event listener to form submission
    const form = document.querySelector('form');
    form.addEventListener('submit', function (event) {
        const password = passwordField.value;
        const confirmPassword = confirmPasswordField.value;

        if (!validatePassword(password)) {
            event.preventDefault();
            alert('Mật khẩu phải có ít nhất 8 ký tự, bao gồm ít nhất 1 ký tự viết hoa và 1 ký tự số, và không chứa ký tự có dấu và dấu cách.');
            return;
        }

        if (password !== confirmPassword) {
            event.preventDefault();
            alert('Mật khẩu và xác nhận mật khẩu không khớp.');
        }
    });

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
<script src="~/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
